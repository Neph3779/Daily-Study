## 동시 요청 - 멀티 쓰레드

- 응답이 들어오면 이를 서블릿 객체와 연결시켜줘야함
- 하나의 응답은 하나의 쓰레드를 통해 처리해줌



### 요청의 수만큼 쓰레드를 생성하면

- 장점
  - 사용자가 지연 없이 서비스를 제공받을 수 있음
  - 리소스를 한계까지 사용할 수 있음
- 단점
  - 요청이 많이 들어오는 경우 CPU, 메모리에 과부하가 발생해 서버가 죽을 수 있음



### 쓰레드 풀

- 요청의 수만큼 쓰레드를 생성하면 서버가 죽을 우려가 있으니 일정 개수의 쓰레드를 미리 생성해두는 전략
- 쓰레드 풀에서 쓰레드를 골라 사용한 뒤, 반납하는 구조
- 쓰레드 풀에 쓰레드가 없다면 쓰레드 풀이 채워질때까지 대기시키거나, 요청 자체를 거절
  - 대기 시킬때도 한도가 필요
- 장점
  - 쓰레드가 미리 생성되어 있으므로 쓰레드를 생성하고 종료하는 비용 절약, 시간 단축 가능
  - 요청으로 인해 서버가 죽을 우려가 없음

### 튜닝

- WAS의 주요 튜닝 포인트는 Max Thread의 수
- 값이 너무 낮으면? 
  - 서버 리소스를 다 쓰지 못함
    - 돈은 돈대로 그 값을 다 뽑아먹지 못한다는 의미
  - 클라이언트 응답 지연이 늘어남
- 값이 너무 높으면?
  - 서버가 죽음
- 장애 발생시 대처법
  - 클라우드라면 서버를 늘리고, 이후에 튜닝
  - 클라우드가 아니라면 바로 튜닝
- 적정 쓰레드 숫자를 찾는 방법
  - 가장 대표적인 방법은 실제 서비스와 유사하게 성능 테스트를 하는 것
  - 툴: 아파치 ab, 제이미터, nGrinder 등



### WAS의 멀티 쓰레드 지원

- 멀티 쓰레드에 대한 부분은 WAS가 처리해줌
- 즉, 개발자는 멀티 쓰레드 관련 코드에 대해선 신경쓰지 않아도 됨
- 하지만 멀티 쓰레드에서 동작한다는 사실을 인지하고 싱글톤 객체 사용시 공유되는 값에 주의해야함



## 서버가 제공하는 것들

### HTML

- 정적 리소스
  - 말그대로 정적인 리소스로, 서버에 저장된 HTML 파일을 그대로 제공
- 동적 리소스
  - 가변적인 요소들(고객의 정보, 제품 등)을 가지고 HTML 파일을 만들어서 제공

### HTTP API

- 주로 JSON 형식을 사용하여 내려주는 데이터
- 주로 클라이언트에게 내려주지만, 서버와 서버가 API를 통해 통신하는 경우도 있음

### CSR (Client Side Rendering)

- Client쪽에서 코드를 돌려 결과물을 내는 것을 CSR이라고 함
- CSR을 통해 화면을 띄우는 과정
  	1. 서버에게 html을 요청하면, 서버는 html 대신 자바스크립트 링크를 보내줌
  	1. 자바스크립트 링크를 통해 자바스크립트를 요청하면 서버는 이를 내려줌
  	1. 만약 필요한 데이터가 있다면 HTTP API를 통해 데이터를 내려줌

### SSR (Server Side Rednering)

- 위에서 언급한 동적 리소스를 제공하는 것을 SSR이라 말함
- 요청에 따라 가변적인 요소들을 가지고 HTML을 만들어주는 것



## 회고

### 잘한점

### 개선점

- 컨디션 난조로 또 하루를 미뤄서 공부하게 되었다.
  - 컨디션이 안좋을때도 3시간을 채워야한다는 부담감이 공부 종료 자체를 미뤄버리는 결과를 가져왔다.
  - 컨디션이 안좋은 날은 공부 시간을 좀 줄여보는것도 좋을 것 같다.
    - 남용되지 않도록 주의해야할 것 같다.