## Transaction

### Commit

- 어떤 sql문을 실행하고, 이를 실제로 반영하기 위해선 commit 과정이 필요
- 실행된 sql문들로 인해 나온 결과를 한번에 반영하는 것
  - 커밋 호출 전까지는 임시로 데이터를 저장해둠
- 만약 sql문들을 실행하다 오류가 발생하면 이를 commit하지 않고 rollback함



### Commit 시스템이 없다면?

- 만약 커밋 시스템이 없다면, 데이터 정합성에 문제가 발생할 수 있음
  - 이체라는 트랜잭션을 실행한다고 가정해보면
    1. 송신자의 계좌로부터 돈을 빼낸다
    2. 수신자의 계좌에 돈을 추가한다.
  - 위의 과정이 진행되어야 하는데, 만약 2번 과정을 진행하다 오류가 발생한다면
    - 이미 반영된 1번 과정을 롤백할 수 없기 때문에 문제 발생



### 자동 커밋 vs 수동 커밋

- 기본적으로 sql 옵션에 자동 커밋이 켜져있음
  - 하나의 sql문을 실행할때마다 모두 commit 됨
- 수동 커밋을 키면 commit 명령어를 실행하기 전까지는 commit되지 않음
  - 즉, rollback이 가능해짐
  - 즉, 수동 커밋을 킴으로 인해 트랜잭션이 시작됨



### 에러 발생시 rollback

- 만약 어떤 쿼리문을 실행하다 에러가 발생하면 이를 rollback하여 원상복구 해야함
- 원자성을 지키기 위해선 어떤 트랜잭션이 "모두 실행"되거나 "아무것도" 실행되지 않아야 함



